!function(){"use strict";function t(t){this.mime="application/vnd.ms-excel",this.fileExtension=".xls",this.mapping=null,Object.byString=function(t,e){if("function"==typeof t[e])return t[e]();let i=(e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split(".");for(let e=0,n=i.length;e<n;++e){let n=i[e];if(!(n in t))return;t=t[n]}return t},this.getMimeType=function(){return this.mime},this.getFileExtension=function(){return this.fileExtension},this.setMapping=function(t){this.mapping=t},this.processHeader=function(e){let i=[];if(null==this.mapping)"function"!=typeof Object.keys&&alert("Cannot transform data, Object.keys function is not available."),i=Object.keys(e[0]);else for(let e=0;e<this.mapping.length;e++){let n=this.mapping[e].headerCellFilter?t(this.mapping[e].headerCellFilter)(this.mapping[e].displayName):this.mapping[e].displayName;i.push(n)}let n="<tr>";for(let t=0;t<i.length;t++)n+="<td>"+i[t]+"</td>";return n+="</tr>",n},this.transform=function(t){let e="";if(e+=this.processHeader(t),null==this.mapping)for(let i=0;i<t.length;i++){e+="<tr>";for(let n in t[i])e+="<td>"+t[i][n]+"</td>";e+="</tr>"}else for(let i=0;i<t.length;i++){e+="<tr>";for(let n=0;n<this.mapping.length;n++)this.mapping[n].field&&(e+="<td>"+Object.byString(t[i],this.mapping[n].field)+"</td>");e+="</tr>"}let i="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Angular Export Excel</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>";return i+=e,i+="</table></body></html>",i}}angular.module("angular.data.export.excel",[]).factory("dataExportExcelService",["$filter",function(e){return new t(e)}])}(),function(){"use strict";function t(t,e,i){this.mapping=null,this.module=null,this.setDataMapping=function(t){this.mapping=t},this.transform=function(t,i){return this.module=e.get(i),null!=this.mapping&&this.module.setMapping(this.mapping),this.module.transform(t)},this.transformAndDownload=function(t,e,n){let l=this.transform(t,e);null==n&&(n="exportData"+this.module.getFileExtension()),i.setMimeType(this.module.getMimeType()),i.downloadFile(n,l)}}angular.module("angular.data.export",["base64","angular.download.service"]).factory("dataExportService",["$base64","$injector","fileDownloadService",function(e,i,n){return new t(e,i,n)}])}();