!function(){"use strict";function e(){this.mime="application/vnd.ms-excel",this.fileExtension=".xls",this.excel="",this.mapping=null,Object.byString=function(e,t){t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");for(var i=t.split("."),n=0,s=i.length;s>n;++n){var r=i[n];if(!(r in e))return;e=e[r]}return e},this.getMimeType=function(){return this.mime},this.getFileExtension=function(){return this.fileExtension},this.setMapping=function(e){this.mapping=e},this.processHeader=function(e){var t=[];if(null==this.mapping)"function"!=typeof Object.keys&&alert("Cannot transform data, Object.keys function is not available."),t=Object.keys(e[0]);else for(var i=0;i<this.mapping.length;i++)t.push(this.mapping[i].displayName);this.excel+="<tr>";for(var i=0;i<t.length;i++)this.excel+="<td>"+t[i]+"</td>";this.excel+="</tr>"},this.transform=function(e){if(this.processHeader(e),null==this.mapping)for(var t=0;t<e.length;t++){this.excel+="<tr>";for(var i in e[t])this.excel+="<td>"+e[t][i]+"</td>";this.excel+="</tr>"}else for(var t=0;t<e.length;t++){this.excel+="<tr>";for(var n=0;n<this.mapping.length;n++)this.excel+="<td>"+Object.byString(e[t],this.mapping[n].field)+"</td>";this.excel+="</tr>"}var s="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Angular Export Excel</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>";return s+=this.excel,s+="</table></body></html>"}}var t=angular.module("angular.data.export.excel",[]);t.factory("dataExportExcelService",function(){return new e})}(),function(){"use strict";function e(e,t,i){this.mapping=null,this.module=null,this.setDataMapping=function(e){this.mapping=e},this.transform=function(e,i){return this.module=t.get(i),null!=this.mapping&&this.module.setMapping(this.mapping),this.module.transform(e)},this.transformAndDownload=function(e,t,n){var s=this.transform(e,t);void 0==n&&(n="exportData"+this.module.getFileExtension()),i.setMimeType(this.module.getMimeType()),i.downloadFile(n,s)}}var t=angular.module("angular.data.export",["base64","angular.download.service"]);t.factory("dataExportService",["$base64","$injector","fileDownloadService",function(t,i,n){return new e(t,i,n)}])}();