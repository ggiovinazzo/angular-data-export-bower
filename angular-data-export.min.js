!function(){"use strict";function t(){this.mime="application/vnd.ms-excel",this.fileExtension=".xls",this.mapping=null,Object.byString=function(t,e){e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var n=e.split("."),i=0,r=n.length;r>i;++i){var o=n[i];if(!(o in t))return;t=t[o]}return t},this.getMimeType=function(){return this.mime},this.getFileExtension=function(){return this.fileExtension},this.setMapping=function(t){this.mapping=t},this.processHeader=function(t){var e=[];if(null==this.mapping)"function"!=typeof Object.keys&&alert("Cannot transform data, Object.keys function is not available."),e=Object.keys(t[0]);else for(var n=0;n<this.mapping.length;n++)e.push(this.mapping[n].displayName);for(var i="<tr>",r=0;r<e.length;r++)i+="<td>"+e[r]+"</td>";return i+="</tr>"},this.transform=function(t){var e="";if(e+=this.processHeader(t),null==this.mapping)for(var n=0;n<t.length;n++){e+="<tr>";for(var i in t[n])e+="<td>"+t[n][i]+"</td>";e+="</tr>"}else for(var r=0;r<t.length;r++){e+="<tr>";for(var o=0;o<this.mapping.length;o++)this.mapping[o].field&&(e+="<td>"+Object.byString(t[r],this.mapping[o].field)+"</td>");e+="</tr>"}var a="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Angular Export Excel</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>";return a+=e,a+="</table></body></html>"}}var e=angular.module("angular.data.export.excel",[]);e.factory("dataExportExcelService",function(){return new t})}(),function(){"use strict";function t(t,e,n){this.mapping=null,this.module=null,this.setDataMapping=function(t){this.mapping=t},this.transform=function(t,n){return this.module=e.get(n),null!=this.mapping&&this.module.setMapping(this.mapping),this.module.transform(t)},this.transformAndDownload=function(t,e,i){var r=this.transform(t,e);void 0==i&&(i="exportData"+this.module.getFileExtension()),n.setMimeType(this.module.getMimeType()),n.downloadFile(i,r)}}var e=angular.module("angular.data.export",["base64","angular.download.service"]);e.factory("dataExportService",["$base64","$injector","fileDownloadService",function(e,n,i){return new t(e,n,i)}])}();